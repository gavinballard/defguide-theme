(function($) {

  // Add a listener for "submit on change" <select> elements.
  $(document).on('change', '[data-submit-on-change]', function() {
    var $select = $(this), target = $select.attr('data-submit-on-change');
    $(target).submit();
  });

  // Add a listener for "Ajax load on submit" <form> elements.
  $(document).on('submit', '[data-submit-load]', function(e) {
    e.preventDefault();
    var $form = $(this),
        target = $form.attr('data-submit-load'),
        url = $form.attr('action'),
        data = $form.serialize();
    $(target).load(url + ' ' + target, data, function() {
      window.history.pushState({}, null, url + '?' + data);
    });
  });

  // Remove the 'no-js' class from the body element, as JS is now available and initialised.
  $('body').removeClass('no-js');

})(jQuery);
